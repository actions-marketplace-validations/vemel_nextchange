module.exports=function(i){"use strict";var r={};function s(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}},n=!0;try{i[e].call(t.exports,t,t.exports,s),n=!1}finally{n&&delete r[e]}return t.l=!0,t.exports}return s.ab=__dirname+"/",s(325)}({82:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toCommandValue=function(e){return null==e?"":"string"==typeof e||e instanceof String?e:JSON.stringify(e)}},87:function(e){e.exports=require("os")},102:function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(747)),s=i(n(87)),o=n(82);t.issueCommand=function(e,t){var n=process.env[`GITHUB_${e}`];if(!n)throw new Error(`Unable to find environment variable for file command ${e}`);if(!r.existsSync(n))throw new Error(`Missing file at path: ${n}`);r.appendFileSync(n,`${o.toCommandValue(t)}${s.EOL}`,{encoding:"utf8"})}},163:function(e,t){"use strict";function n(e){const t=[];for(var n of e.split(/\r?\n/))n=n.trimRight(),(n.length||t.length)&&t.push(n);for(;t.length&&0===t[t.length-1].trim().length;)t.pop();return t.join("\n")}function i(e){let t=-1,n=!0;const i=e.split(/\r?\n/);for(const s of i){var r=s.length-s.trimLeft().length;n?(r&&(t=r),n=!1):(t<0||t>r)&&(t=r)}return t<=0?e:(i.length&&i[0].length===i[0].trimLeft().length&&(i[0]=new Array(t).fill(" ").join("")+i[0]),i.map(e=>e.substr(t)).join("\n"))}function r(e){return i(n(e))}Object.defineProperty(t,"__esModule",{value:!0}),t.joinText=t.trimDedent=t.dedent=t.trimLines=void 0,t.trimLines=n,t.dedent=i,t.trimDedent=r,t.joinText=function(e,...t){return t.map(e=>r(e)).filter(e=>e).join(e)}},211:function(e,t){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.ENCODING=t.HEADER=t.UNRELEASED=t.SECTION_TITLES=t.Labels=t.SectionTitles=t.Outputs=t.Inputs=void 0,(n=t.Inputs||(t.Inputs={})).Path="path",n.Encoding="encoding",n.Release="release",n.Get="get",n.Set="set",n.Append="append",n.SectionSuffix="suffix",n.Save="save",n.Sanitize="sanitize",(i=t.Outputs||(t.Outputs={})).Titles="titles",i.Label="label",i.Result="result",(i=n=t.SectionTitles||(t.SectionTitles={})).Added="added",i.Changed="changed",i.Deprecated="deprecated",i.Removed="removed",i.Fixed="fixed",i.Security="security",(i=t.Labels||(t.Labels={})).Major="major",i.Minor="minor",i.Patch="patch",t.SECTION_TITLES=Object.values(n),t.UNRELEASED="unreleased",t.HEADER=`# Changelog
All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).`,t.ENCODING="utf-8"},312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(211),r=n(163);t.default=class{constructor(e,t=""){this.title=e.toLowerCase(),this.body=r.trimDedent(t)}static isValidTitle(e){const t=Object.values(i.SectionTitles);return t.includes(e.toLowerCase())}renderTitle(){return`### ${this.title[0].toUpperCase()}${this.title.substr(1)}`}render(){return this.body?`${this.renderTitle()}\n${this.body}`:this.renderTitle()}isEmpty(){return 0===this.body.length}append(e){return this.body=`${this.body}${e}`,this}appendLines(e){return this.body=r.joinText("\n",this.body,e),this}set(e){return this.body=r.trimDedent(e),this}}},325:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){e[i=void 0===i?n:i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},o=this&&this.__awaiter||function(e,o,u,a){return new(u=u||Promise)(function(n,t){function i(e){try{s(a.next(e))}catch(e){t(e)}}function r(e){try{s(a.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(i,r)}s((a=a.apply(e,o||[])).next())})},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const f=s(n(470)),p=u(n(361)),h=n(211),g=u(n(484)),m=u(n(866));function a(){return o(this,void 0,void 0,function*(){try{var n=f.getInput(h.Inputs.Path)||"./CHANGELOG.md",i=f.getInput(h.Inputs.Encoding)||h.ENCODING,r=f.getInput(h.Inputs.Release),s="true"===(f.getInput(h.Inputs.Save)||"true"),o=f.getInput(h.Inputs.SectionSuffix)||"",u=f.getInput(h.Inputs.Set),a=f.getInput(h.Inputs.Get)||h.UNRELEASED,l=f.getInput(h.Inputs.Append);const c=p.default.readOrCreate(n,i);let e=!1,t=c.getRelease(a)||new g.default(a);if(f.debug(`Target release is ${t.version}`),u&&(f.debug(`Replacing notes in ${t.version}`),t.body=m.default.parse(u).addSectionSuffix(o),e=!0),l&&(f.debug(`Updating notes in ${t.version}`),t.body.merge(m.default.parse(l).sanitize().addSectionSuffix(o)),e=!0,f.debug(`Updated notes in ${t.version}`)),r){const d=c.getOrCreateRelease(r);f.debug(`Releasing ${d.version}`),d.body=t.body,f.debug(`Cleaning up ${t.version}`),t.body=new m.default,t=d,e=!0}s&&e&&(f.debug(`Saving changes to ${n}`),c.write(n,i)),f.setOutput(h.Outputs.Result,t.body.render()),f.setOutput(h.Outputs.Label,t.body.getLabel()),f.setOutput(h.Outputs.Titles,t.body.getTitles().join(","))}catch(e){f.setFailed(e.message)}})}a(),t.default=a},361:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(747)),o=n(211),u=i(n(484)),r=i(n(866)),a=n(163);class l{constructor(e="",t=new u.default("Unreleased"),n=[]){this.header=e,this.unreleased=t,this.releases=n,this.isCRLF=!1}static parse(e){const[t,...n]=e.split(/^## \[/m),i=n.map(e=>u.default.parse(`## [${e}`));var r=i.filter(e=>e.version.toLowerCase()===o.UNRELEASED),e=i.filter(e=>e.version.toLowerCase()!==o.UNRELEASED),r=r.length?r[0]:new u.default("Unreleased");return new l(a.trimDedent(t),r,e)}static read(e,t=o.ENCODING){let n=s.default.readFileSync(e,{encoding:t}),i=!1;n.includes("\r\n")&&(n=n.replace(/\r?\n/g,"\n"),i=!0);const r=l.parse(n);return r.isCRLF=i,r}getRelease(t){if("unreleased"===t.toLowerCase())return this.unreleased;var e=this.releases.filter(e=>e.version===t);return e.length?e[0]:null}getOrCreateRelease(e){var t=this.getRelease(e);if(t)return t;e=new u.default(e,"",new r.default);return this.releases=[e,...this.releases],e}renderReleases(){return this.releases.map(e=>e.render()).join("\n\n")}render(){return[this.header,this.unreleased.render(),this.renderReleases()].filter(e=>e).join("\n\n")}write(e,t=o.ENCODING){let n=this.render();this.isCRLF&&(n=n.replace(/\r?\n/g,"\r\n")),s.default.writeFileSync(e,n,{encoding:t})}static readOrCreate(e,t=o.ENCODING){return s.default.existsSync(e)?l.read(e,t):new l(o.HEADER)}}t.default=l},431:function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(87)),s=n(82);function o(e,t,n){const i=new u(e,t,n);process.stdout.write(i.toString()+r.EOL)}t.issueCommand=o,t.issue=function(e,t=""){o(e,{},t)};class u{constructor(e,t,n){this.command=e=e||"missing.command",this.properties=t,this.message=n}toString(){let t="::"+this.command;if(this.properties&&0<Object.keys(this.properties).length){t+=" ";let e=!0;for(const i in this.properties)!this.properties.hasOwnProperty(i)||(n=this.properties[i])&&(e?e=!1:t+=",",t+=`${i}=${n=n,s.toCommandValue(n).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}`)}var n,e;return t+=`::${e=this.message,s.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}`,t}}},470:function(e,t,n){"use strict";var i,r=this&&this.__awaiter||function(e,o,u,a){return new(u=u||Promise)(function(n,t){function i(e){try{s(a.next(e))}catch(e){t(e)}}function r(e){try{s(a.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(i,r)}s((a=a.apply(e,o||[])).next())})},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=n(431),u=n(102),a=n(82),l=s(n(87)),c=s(n(622));function d(e){o.issue("error",e instanceof Error?e.toString():e)}function f(e){o.issue("group",e)}function p(){o.issue("endgroup")}(n=i=t.ExitCode||(t.ExitCode={}))[n.Success=0]="Success",n[n.Failure=1]="Failure",t.exportVariable=function(e,t){var n=a.toCommandValue(t);process.env[e]=n,process.env.GITHUB_ENV||""?(t=`${e}<<${t="_GitHubActionsFileCommandDelimeter_"}${l.EOL}${n}${l.EOL}${t}`,u.issueCommand("ENV",t)):o.issueCommand("set-env",{name:e},n)},t.setSecret=function(e){o.issueCommand("add-mask",{},e)},t.addPath=function(e){process.env.GITHUB_PATH||""?u.issueCommand("PATH",e):o.issueCommand("add-path",{},e),process.env.PATH=`${e}${c.delimiter}${process.env.PATH}`},t.getInput=function(e,t){const n=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!n)throw new Error(`Input required and not supplied: ${e}`);return n.trim()},t.setOutput=function(e,t){o.issueCommand("set-output",{name:e},t)},t.setCommandEcho=function(e){o.issue("echo",e?"on":"off")},t.setFailed=function(e){process.exitCode=i.Failure,d(e)},t.isDebug=function(){return"1"===process.env.RUNNER_DEBUG},t.debug=function(e){o.issueCommand("debug",{},e)},t.error=d,t.warning=function(e){o.issue("warning",e instanceof Error?e.toString():e)},t.info=function(e){process.stdout.write(e+l.EOL)},t.startGroup=f,t.endGroup=p,t.group=function(t,n){return r(this,void 0,void 0,function*(){f(t);let e;try{e=yield n()}finally{p()}return e})},t.saveState=function(e,t){o.issueCommand("save-state",{name:e},t)},t.getState=function(e){return process.env[`STATE_${e}`]||""}},484:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(866));class o{constructor(e,t="",n=null){this.version=e,this.createdAt=t,this.body=n||new s.default}static parseTitle(e){const t=e.split(" ").map(e=>e.trim()).filter(e=>e);if(t.length<2)return["",""];e=t[1].replace("[","").replace("]","").trim();return t.length<3?[e,""]:[e,t.slice(3).join(" ")]}static parse(e){const[t,...n]=e.split(/\r?\n/);var i=n.join("\n"),[r,e]=o.parseTitle(t);return new o(r,e,s.default.parse(i))}renderTitle(){return this.createdAt?`## [${this.version}] - ${this.createdAt}`:`## [${this.version}]`}render(){return[this.renderTitle(),this.body.render()].filter(e=>e).join("\n")}}t.default=o},622:function(e){e.exports=require("path")},747:function(e){e.exports=require("fs")},866:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(211),l=i(n(312)),r=n(163),c=/^### (\S+)/;t.default=class u{constructor(e=[],t="",n=""){this.sectionTitles=Object.values(a.SectionTitles),this.prefix=r.trimDedent(t),this.postfix=r.trimDedent(n),this.sections=this.sectionTitles.map(e=>new l.default(e,"")),e.map(e=>{this.getSection(e.title).appendLines(e.body)})}static parse(e){let t=!1,n="prefix";const i=new Map([["prefix",[]],["postfix",[]]]);a.SECTION_TITLES.forEach(e=>i.set(e,[]));for(const r of e.split(/\r?\n/)){if(r.trim().startsWith("```")&&(t=!t),!t&&r.startsWith("#")){const o=r.match(c);if(o){n=o[1].toLowerCase();continue}"prefix"!==n&&(n="postfix")}const s=i.get(n);s&&s.push(r)}return e=a.SECTION_TITLES.map(e=>new l.default(e,(i.get(e)||[]).join("\n"))),new u(e,(i.get("prefix")||[]).join("\n"),(i.get("postfix")||[]).join("\n"))}getSection(t){var e=this.sections.filter(e=>e.title===t);if(e.length)return e[0];throw new Error(`Section title ${t} is invalid`)}getExistingSections(){return this.sections.filter(e=>!e.isEmpty())}renderSections(){return this.getExistingSections().map(e=>e.render()).join("\n\n")}render(){return[this.prefix,this.renderSections(),this.postfix].filter(e=>e.length).join("\n\n")}isEmpty(){return!this.prefix&&!this.postfix&&0===this.getExistingSections().length}getTitles(){return this.getExistingSections().map(e=>e.title)}getLabel(){const e=this.getTitles();return e.includes(a.SectionTitles.Removed)?a.Labels.Major:e.includes(a.SectionTitles.Added)||e.includes(a.SectionTitles.Changed)||e.includes(a.SectionTitles.Deprecated)?a.Labels.Minor:a.Labels.Patch}sanitize(){return this.prefix="",this.postfix="",this}merge(e){return this.prefix=r.joinText("\n",this.prefix,e.prefix),this.postfix=r.joinText("\n",this.postfix,e.postfix),e.sections.map(e=>{this.getSection(e.title).appendLines(e.body)}),this}addSectionSuffix(t){return t&&this.getExistingSections().forEach(e=>e.append(t)),this}}}});
